{"version":3,"sources":["../node_modules/relative-date/lib/relative-date.js","components/Item/Item.module.css","pages/TopStoriesPage/TopStoriesPage.module.css","../node_modules/react-use/esm/useIntersection.js","hooks/useItem.js","components/Item/Item.jsx","utils/parse-domain.js","utils/get-hotness.js","pages/TopStoriesPage/TopStoriesPage.jsx"],"names":["relativeDate","undefined","DAY","YEAR","formats","Number","MAX_VALUE","input","reference","Date","getTime","format","i","len","delta","length","Math","round","module","exports","useIntersection","ref","options","_a","useState","intersectionObserverEntry","setIntersectionObserverEntry","useEffect","current","IntersectionObserver","observer_1","entries","observe","disconnect","threshold","root","rootMargin","fetchItem","async","_key","id","ky","get","endpoints","json","Item","className","error","isLoading","item","data","useQuery","refetchOnWindowFocus","retry","staleTime","commentCount","descendants","score","title","url","author","by","postedAt","time","useItem","styles","Spinner","urlDomain","urlString","URL","domain","host","match","domainParts","split","parseDomain","hotness","getHotness","prettyDate","href","comments","rel","upvote","aria-hidden","source","authorHandle","dateTime","toISOString","withPageLayout","topStories","queryCache","getQueryData","stories","setStories","loadingZoneEl","useRef","intersection","latestStoryFetchedIndex","indexOf","nextItemId","hasMoreItems","Boolean","isIntersecting","itemList","map","itemId","index","key","evenItem","pageTitle"],"mappings":"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","file":"static/js/3.f02793e5.chunk.js","sourcesContent":["var relativeDate = (function(undefined){\n\n  var SECOND = 1000,\n      MINUTE = 60 * SECOND,\n      HOUR = 60 * MINUTE,\n      DAY = 24 * HOUR,\n      WEEK = 7 * DAY,\n      YEAR = DAY * 365,\n      MONTH = YEAR / 12;\n\n  var formats = [\n    [ 0.7 * MINUTE, 'just now' ],\n    [ 1.5 * MINUTE, 'a minute ago' ],\n    [ 60 * MINUTE, 'minutes ago', MINUTE ],\n    [ 1.5 * HOUR, 'an hour ago' ],\n    [ DAY, 'hours ago', HOUR ],\n    [ 2 * DAY, 'yesterday' ],\n    [ 7 * DAY, 'days ago', DAY ],\n    [ 1.5 * WEEK, 'a week ago'],\n    [ MONTH, 'weeks ago', WEEK ],\n    [ 1.5 * MONTH, 'a month ago' ],\n    [ YEAR, 'months ago', MONTH ],\n    [ 1.5 * YEAR, 'a year ago' ],\n    [ Number.MAX_VALUE, 'years ago', YEAR ]\n  ];\n\n  function relativeDate(input,reference){\n    !reference && ( reference = (new Date).getTime() );\n    reference instanceof Date && ( reference = reference.getTime() );\n    input instanceof Date && ( input = input.getTime() );\n    \n    var delta = reference - input,\n        format, i, len;\n\n    for(i = -1, len=formats.length; ++i < len; ){\n      format = formats[i];\n      if(delta < format[0]){\n        return format[2] == undefined ? format[1] : Math.round(delta/format[2]) + ' ' + format[1];\n      }\n    };\n  }\n\n  return relativeDate;\n\n})();\n\nif(typeof module != 'undefined' && module.exports){\n  module.exports = relativeDate;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"Item_item__3PAef\",\"comments\":\"Item_comments__2R1et\",\"score\":\"Item_score__U5BaO\",\"hot\":\"Item_hot__1TwxB\",\"mild\":\"Item_mild__3MEuQ\",\"medium\":\"Item_medium__3Ch-L\",\"upvote\":\"Item_upvote___Ot76\",\"title\":\"Item_title__1YNHH\",\"source\":\"Item_source__3SAo2\",\"author\":\"Item_author__yoxnY\",\"authorHandle\":\"Item_authorHandle__3o-Iz\",\"postedAt\":\"Item_postedAt__8cZLK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"evenItem\":\"TopStoriesPage_evenItem__3P4jD\"};","/* eslint-disable */\nimport { useEffect, useState } from 'react';\nvar useIntersection = function (ref, options) {\n    var _a = useState(null), intersectionObserverEntry = _a[0], setIntersectionObserverEntry = _a[1];\n    useEffect(function () {\n        if (ref.current && typeof IntersectionObserver === 'function') {\n            var handler = function (entries) {\n                setIntersectionObserverEntry(entries[0]);\n            };\n            var observer_1 = new IntersectionObserver(handler, options);\n            observer_1.observe(ref.current);\n            return function () {\n                setIntersectionObserverEntry(null);\n                observer_1.disconnect();\n            };\n        }\n        return function () { };\n    }, [ref.current, options.threshold, options.root, options.rootMargin]);\n    return intersectionObserverEntry;\n};\nexport default useIntersection;\n","import ky from 'ky-universal';\nimport { useQuery } from 'react-query';\n\nimport endpoints from 'src/utils/endpoints-helper';\n\nconst fetchItem = async (_key, id) => {\n  return ky.get(endpoints('item', { id })).json();\n};\n\nexport default (id) => {\n  const { error, isLoading, data } = useQuery(['item', id], fetchItem, {\n    refetchOnWindowFocus: false,\n    retry: false,\n    staleTime: 5 * 60 * 1000,\n  });\n\n  return {\n    error,\n    isLoading,\n    item: data\n      ? {\n          id: data.id,\n          commentCount: data.descendants,\n          score: data.score,\n          title: data.title,\n          url: data.url,\n          author: data.by,\n          postedAt: data.time * 1000,\n        }\n      : {},\n  };\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport relativeDate from 'relative-date';\n\nimport useItem from 'src/hooks/useItem';\n\nimport Spinner from 'src/components/Spinner/Spinner';\n\nimport parseDomain from 'src/utils/parse-domain';\nimport getHotness from 'src/utils/get-hotness';\n\nimport styles from './Item.module.css';\n\nconst Item = ({ id, className }) => {\n  const { error, isLoading, item } = useItem(id);\n\n  if (error) {\n    return (\n      <article className={`${styles.item}${className ? ` ${className}` : ``}`}>\n        There was an error requesting the item.\n      </article>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <article className={`${styles.item}${className ? ` ${className}` : ``}`}>\n        <Spinner className=\"block-center\" />\n      </article>\n    );\n  }\n\n  const { commentCount, score, title, url, author, postedAt } = item;\n\n  const urlDomain = parseDomain(url);\n  const hotness = getHotness(score);\n  const prettyDate = relativeDate(postedAt);\n\n  return (\n    <article className={`${styles.item}${className ? ` ${className}` : ``}`}>\n      <a\n        href={`https://news.ycombinator.com/item?id=${id}`}\n        className={styles.comments}\n        rel=\"nofollow noreferrer noopener\"\n      >\n        {commentCount ?? `-`}{' '}\n        <span className=\"sr-only\">{commentCount === 1 ? `comment` : `comments`}</span>\n      </a>{' '}\n      <span className={`${styles.score} ${styles[hotness]}`}>\n        {score} <span className=\"sr-only\">{score === 1 ? `upvote` : `upvotes`}</span>\n      </span>{' '}\n      <a\n        href={`https://news.ycombinator.com/vote?id=${id}&how=up&goto=news%3Fp%3D2`}\n        className={styles.upvote}\n        rel=\"nofollow noreferrer noopener\"\n      >\n        <span aria-hidden=\"true\">&#9650;</span>\n        <span className=\"sr-only\">Upvote story</span>\n      </a>{' '}\n      <div>\n        <a\n          href={url ?? `https://news.ycombinator.com/item?id=${id}`}\n          className={styles.title}\n          rel=\"nofollow noreferrer noopener\"\n        >\n          {title}\n        </a>{' '}\n        {urlDomain && (\n          <>\n            <span className={styles.source}>\n              <span aria-hidden=\"true\">(</span>\n              {urlDomain}\n              <span aria-hidden=\"true\">)</span>\n            </span>{' '}\n          </>\n        )}\n        <span className={styles.author}>\n          by{' '}\n          <a\n            href={`https://news.ycombinator.com/user?id=${author}`}\n            className={styles.authorHandle}\n            rel=\"nofollow noreferrer noopener\"\n          >\n            {author}\n          </a>\n        </span>{' '}\n        <time dateTime={new Date(postedAt).toISOString()} className={styles.postedAt}>\n          {prettyDate}\n        </time>\n      </div>\n    </article>\n  );\n};\n\nItem.propTypes = {\n  id: PropTypes.number.isRequired,\n  className: PropTypes.string,\n};\n\nexport default Item;\n","export default (urlString) => {\n  let url;\n\n  try {\n    url = new URL(urlString);\n  } catch {\n    return null;\n  }\n\n  const domain = url.host;\n\n  if (domain.match(/\\./g).length > 1) {\n    const domainParts = domain.split('.');\n    return `${domainParts[domainParts.length - 2]}.${domainParts[domainParts.length - 1]}`;\n  }\n\n  return domain;\n};\n","export default (score) => {\n  if (score < 50) {\n    return '';\n  }\n\n  if (score < 75) {\n    return 'mild';\n  }\n\n  if (score < 100) {\n    return 'medium';\n  }\n\n  return 'hot';\n};\n","import React, { useState, useRef, useEffect } from 'react';\nimport { queryCache } from 'react-query';\nimport { useIntersection } from 'react-use';\n\nimport withPageLayout from 'src/hocs/withPageLayout';\n\nimport Item from 'src/components/Item/Item';\n\nimport styles from './TopStoriesPage.module.css';\n\nconst TopStoriesPage = () => {\n  const topStories = queryCache.getQueryData('topStories');\n\n  const [stories, setStories] = useState([]);\n\n  const loadingZoneEl = useRef(null);\n  const intersection = useIntersection(loadingZoneEl, {\n    rootMargin: '60px',\n    threshold: 0.01,\n  });\n\n  useEffect(() => {\n    setStories([...stories, topStories[0]]);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    if (stories.length > 0) {\n      const latestStoryFetchedIndex = topStories.indexOf(stories[stories.length - 1]);\n      const nextItemId = topStories[latestStoryFetchedIndex + 1] ?? null;\n      const hasMoreItems = Boolean(nextItemId);\n\n      if (intersection && intersection.isIntersecting && hasMoreItems) {\n        setStories([...stories, nextItemId]);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [intersection, stories]);\n\n  return (\n    <>\n      <section className={styles.itemList}>\n        {stories.map((itemId, index) => {\n          return (\n            <Item\n              key={itemId}\n              id={itemId}\n              className={(index + 1) % 2 === 0 ? styles.evenItem : null}\n            />\n          );\n        })}\n      </section>\n\n      <div aria-hidden=\"true\" ref={loadingZoneEl} />\n    </>\n  );\n};\n\nexport default withPageLayout(TopStoriesPage, {\n  pageTitle: 'Top News | Hacker News',\n});\n"],"sourceRoot":""}